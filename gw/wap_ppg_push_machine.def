/*
 * wap_ppg_session_machine.def: macro call to generate the machine to store 
 * data for WAP connected pushes.
 * See architecture document for guidance how to use this.
 *
 * Fields of the machine have following meaning:
 *        a) Identification: pi_push_id, push_id, sender_address
 *
 *        b) Implementing PAP attribute (see PPG Services, Chapter 6):
 *           message_state, code, desc, event_time, delivery_method
 *
 *        c) Session this push uses: session_id, addr_tuple
 *
 *        d) fields to implement time dependent push: timestamp and field to
 *           store the message
 *
 *        e) field to implement priority: a priority field. Priority scheme
 *           stores the message, too.
 *
 *        f) fields to store push message data until the session is establish-
 *           ed: push headers, push data, push capabilities.
 *
 *        g) fields to define network and bearer PI is asking: network_requir-
 *           ed, network, bearer_required, bearer.
 *
 *        h) fields to specify reporting to PI: progress_notes_requested, ppg_
 *           notify_requested_to
 *
 *        i) PI authentication fields: authentication fields for this push: 
 *           authenticared, trusted. 
 *        
 *        j) authorisation fields used when SMS is the bearer: username, pass-
 *           word.
 *
 * By Aarno Syvänen for Wapit Ltd and for Wiral Ltd
 */

#if !defined(MACHINE)
    #error "Macro MACHINE is missing"
#elif !defined(INTEGER)
    #error "Macro INTEGER is missing"
#elif !defined(OCTSTR)
    #error "Macro OCTSTR is missing"
#elif !defined(OPTIONAL_OCTSTR)
    #error "Macro OPTIONAL_OCTSTR is missing"
#elif !defined(ADDRTUPLE)
    #error "Macro ADDRTUPLE is missing"
#elif !defined(CAPABILITIES)
    #error "Macro CAPABILITIES is missing"
#elif !defined(HTTPHEADER)
    #error "Macro HTTPHEADER is missing"
#endif

MACHINE(OCTSTR(pi_push_id)       /* this id is selected by PI and SHOULD 
                                    include data separating different PIs */
        INTEGER(push_id)         /* this id is generated by Kannel */
        OPTIONAL_OCTSTR(sender_address)  /* PPG address known by PI */
        INTEGER(message_state)   /* Implementing PAP attribute */
        INTEGER(code)
        OPTIONAL_OCTSTR(desc)
        OCTSTR(event_time)
        INTEGER(delivery_method)
        INTEGER(session_id)      /* link to the push session */
        ADDRTUPLE(addr_tuple)
        OPTIONAL_OCTSTR(deliver_after_timestamp) /* for time dependent push, 
                                                  in PAP format */
        INTEGER(priority)        /* for QoS attribute priority */
        HTTPHEADER(push_headers) 
        OPTIONAL_OCTSTR(push_data)        
        OPTIONAL_OCTSTR(network) /* defining the network */
        INTEGER(network_required)
        OPTIONAL_OCTSTR(bearer)  /* defining the bearer */
        INTEGER(bearer_required)
        INTEGER(progress_notes_requested)/* do we send progress notes about 
                                            this push */
        OPTIONAL_OCTSTR(ppg_notify_requested_to) /* do we notify PI the 
                                                   results */
        INTEGER(authenticated)   /* transferring trust from the client to
                                    PPG */
        INTEGER(trusted)  
        OPTIONAL_OCTSTR(username) /* SMS center authentication */
        OPTIONAL_OCTSTR(password)  
       )

#undef MACHINE
#undef INTEGER
#undef OCTSTR
#undef OPTIONAL_OCTSTR
#undef ADDRTUPLE
#undef CAPABILITIES
#undef HTTPHEADER
